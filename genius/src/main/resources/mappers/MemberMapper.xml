<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/schema/mybatis-3-mapper.dtd">
<mapper namespace="org.fullstack4.genius.mapper.MemberMapper">
    <select id="view" resultType="org.fullstack4.genius.domain.MemberVO">
        select member_idx,member_id,member_name,pwd,birthday,phone,gender,zip_code,addr1,addr2,point,profile,reg_date,admin_YN,modify_date,leave_date,status,email
        from tbl_member
        where member_id = #{member_id}
    </select>
    <select id="login" resultType="org.fullstack4.genius.domain.MemberVO">
        SELECT member_idx,member_id,member_name,pwd,birthday,phone,gender,zip_code,addr1,addr2,point,profile,reg_date,admin_YN,modify_date,leave_date,status,email,social_type
        FROM tbl_member
        WHERE member_id = #{member_id} AND status = 'Y' AND social_type IS NULL
    </select>
    <select id="naver" resultType="org.fullstack4.genius.domain.MemberVO">
        SELECT member_idx,member_id,member_name,pwd,birthday,phone,gender,zip_code,addr1,addr2,point,profile,reg_date,admin_YN,modify_date,leave_date,status,email,social_type
        FROM tbl_member
        WHERE member_id = #{member_id} AND status = 'Y' AND social_type = 'naver'
    </select>
    <update id="pointcharge">
        update SET tbl_member point=#{point} where member_id=#{member_id}
    </update>
    <insert id="join">
        INSERT INTO tbl_member (social_type, member_id, member_name, pwd, birthday, email, phone, gender, zip_code, addr1, addr2, admin_YN, terms1, terms2, terms3, terms4)
        VALUES (#{social_type}, #{member_id}, #{member_name}, #{pwd}, #{birthday}, #{email}, #{phone}, #{gender}, #{zip_code}, #{addr1}, #{addr2}, 'N', #{terms1}, #{terms2}, #{terms3}, #{terms3})
    </insert>
    <select id="findId" resultType="string">
        SELECT member_id
        FROM tbl_member
        WHERE member_name = #{member_name} AND email = #{email}
    </select>
    <select id="findPwd" resultType="string">
        SELECT member_id
        FROM tbl_member
        WHERE member_id = #{member_id} AND member_name = #{member_name} AND email = #{email}
    </select>
    <update id="changePwd">
        UPDATE tbl_member
        SET pwd = #{pwd}
        WHERE member_id = #{member_id}
    </update>
    <update id="modifyInfo">
        UPDATE tbl_member
        SET member_name = #{member_name},
            pwd = #{pwd},
            birthday = #{birthday},
            email = #{email},
            phone = #{phone},
            gender = #{gender},
            zip_code = #{zip_code},
            addr1 = #{addr1},
            addr2 = #{addr2},
            profile = #{profile},
            modify_date = now()
        WHERE member_id = #{member_id}
    </update>
    <update id="leave">
        UPDATE tbl_member
        SET status = 'N',
            leave_date = now()
        WHERE member_id = #{member_id}
    </update>
</mapper>